(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f54e006"],{"1eda":function(t,e,a){},"2a1c":function(t,e,a){"use strict";a("1eda")},"2ad0":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",[a("el-col",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"font-weight":"bold",color:"#016dbe"}},[t._v("督察报告")]),a("div",{staticClass:"pull-right"},[a("span",{staticStyle:{"font-size":"14px"}},[t._v("时间范围：")]),a("el-date-picker",{staticStyle:{margin:"0 10px 0 10px"},attrs:{size:"small",type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)]),a("el-row",{staticStyle:{height:"200px"}},[a("el-col",{staticClass:"report-item",attrs:{span:4},nativeOn:{click:function(e){return t.openReport(1)}}},[a("img",{staticClass:"img",attrs:{src:t.word}}),a("span",{staticClass:"txt"},[t._v("“五位一体”大监督体系工作报告")])]),a("el-col",{staticClass:"report-item",attrs:{span:4},nativeOn:{click:function(e){return t.openReport(2)}}},[a("img",{staticClass:"img",attrs:{src:t.word}}),a("span",{staticClass:"txt"},[t._v("高发问题统计工作报告")])]),a("el-col",{staticClass:"report-item",attrs:{span:4},nativeOn:{click:function(e){return t.openReport(3)}}},[a("img",{staticClass:"img",attrs:{src:t.word}}),a("span",{staticClass:"txt"},[t._v("各业务警种检查统计报告")])]),a("el-col",{staticClass:"report-item",attrs:{span:4},nativeOn:{click:function(e){return t.openReport(4)}}},[a("img",{staticClass:"img",attrs:{src:t.word}}),a("span",{staticClass:"txt"},[t._v("各单位自查统计报告")])]),a("el-col",{staticClass:"report-item",attrs:{span:4},nativeOn:{click:function(e){return t.openReport(5)}}},[a("img",{staticClass:"img",attrs:{src:t.word}}),a("span",{staticClass:"txt"},[t._v("各单位反馈统计报告")])]),a("el-col",{staticClass:"report-item",attrs:{span:4},nativeOn:{click:function(e){return t.openReport(6)}}},[a("img",{staticClass:"img",attrs:{src:t.word}}),a("span",{staticClass:"txt"},[t._v("问题高发人员统计报告")])])],1)],1)],1)],1)],1)},i=[],n=a("9d9a"),c=a("21a6"),r={data:function(){return{word:a("dccb"),dateRange:[(new Date).getTime()-6048e5,new Date],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}}},methods:{openReport:function(t){var e=this;if(!this.dateRange||this.dateRange.length<1)this.$modal.msgError("请先选择报表的时间范围!");else{this.$modal.loading("正在生成报告..."),this.curReportType=t;var a="",s="";switch(t){case 1:s="getWuWeiYiTi",a="“五位一体”大监督体系工作报告";break;case 2:s="getGaoFaWenTi",a="高发问题统计工作报告";break;case 3:s="getDanWeiJianCha",a="业务警种检查统计报告";break;case 4:s="getDanWeiZiCha",a="各单位自查统计报告";break;case 5:s="getDanWeiFanKui",a="各单位反馈统计报告";break;case 6:s="getGaoFaRenYuan",a="问题高发人员统计报告";break}var i=this;this.$modal.confirm("是否生成【"+a+"】？").then((function(){return i.getFile(s,a)})).then((function(){e.$modal.closeLoading()})).catch((function(){e.$modal.closeLoading()}))}},getFile:function(t,e){var a={};a.start_datetime=this.parseTime(this.dateRange[0],"{y}-{m}-{d}")+" 00:00:00",a.end_datetime=this.parseTime(this.dateRange[1],"{y}-{m}-{d}")+" 23:59:59",Object(n["x"])(t,a).then((function(t){console.log(t.file_name);var a="http://192.168.10.150:9010/webapp/report_file/"+t.file_name;Object(c["saveAs"])(a,e+".docx")}))}}},o=r,l=(a("2a1c"),a("2877")),p=Object(l["a"])(o,s,i,!1,null,null,null);e["default"]=p.exports},dccb:function(t,e,a){t.exports=a.p+"static/img/word.8a797c98.png"}}]);