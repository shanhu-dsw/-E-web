(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52f50c70"],{"0987":function(e,t,i){},"0c6d":function(e,t,i){},"25aa":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"component-upload-image"},[i("el-upload",{attrs:{action:"#","auto-upload":!1,"file-list":e.uploadList2,"on-change":e.onChangeUpload,"on-remove":e.handlerRemoveImage,"before-remove":e.handlerBeforeRemove,"on-exceed":e.onUpdateExceed,drag:"",multiple:"",limit:e.limit}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或"),i("em",[e._v("点击上传")])])]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 请上传 "),e.fileSize?[e._v(" 大小不超过 "),i("b",{staticStyle:{color:"#f56c6c"}},[e._v(e._s(e.fileSize)+"MB")])]:e._e(),e.fileType?[e._v(" 格式为 "),i("b",{staticStyle:{color:"#f56c6c"}},[e._v(e._s(e.fileType.join("/")))])]:e._e(),e._v(" 的文件 ")],2)],1)},o=[],r=i("c7eb"),a=i("1da1"),l=(i("a9e3"),i("4de4"),i("d3b7"),i("b0c0"),i("14d9"),i("fb6a"),i("a15b"),i("3e8f"),{props:{uploadList:[String,Object,Array],limit:{type:Number,default:5},fileSize:{type:Number,default:5},fileType:{type:Array,default:function(){return["png","jpg","jpeg","doc","docx","xls","xlsx","pdf","zip"]}}},computed:{},data:function(){return{uploadList2:[]}},methods:{onChangeUpload:function(e,t){console.log(e);var i=this.validateFile(e);if(!i)return this.uploadList2=this.uploadList2.filter((function(t){return t.uid!==e.uid})),!1;var s=this,o=new FileReader;o.readAsDataURL(e.raw),o.onload=function(t){e.content=o.result,e.suffix=e.name.substring(e.name.lastIndexOf(".")+1).toUpperCase(),s.uploadList2.push(e),s.$emit("update:uploadList",s.uploadList2)}},handlerRemoveImage:function(e,t){var i=this;return Object(a["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i.uploadList2=i.uploadList2.filter((function(t){return t.uid!==e.uid})),i.$emit("update:uploadList",i.uploadList2);case 2:case"end":return t.stop()}}),t)})))()},handlerBeforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},onUpdateExceed:function(){this.$modal.msgError("上传文件数量不能超过 ".concat(this.limit," 个!"))},validateFile:function(e){var t=!1,i="";if(e.name.lastIndexOf(".")>-1&&(i=e.name.slice(e.name.lastIndexOf(".")+1)),t=this.fileType.some((function(e){return!!(i&&i.indexOf(e)>-1)})),!t)return this.$modal.msgError("文件格式不正确, 请上传".concat(this.fileType.join("/"),"格式文件!")),!1;if(this.fileSize){var s=e.size/1024/1024<this.fileSize;if(!s)return this.$modal.msgError("上传文件大小不能超过 ".concat(this.fileSize," MB!")),!1}return!0}}}),n=l,c=(i("6d25"),i("2877")),d=Object(c["a"])(n,s,o,!1,null,"ac32e658",null);t["a"]=d.exports},"3e8f":function(e,t){},"6d25":function(e,t,i){"use strict";i("0c6d")},"6e00":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticStyle:{display:"flex","background-color":"#fff"}},[i("div",{staticClass:"prClass"},[i("el-row",{staticClass:"prHeader",attrs:{type:"flex"}},[i("div",{staticClass:"number"},[e._v(" 问题编号 "),i("span",[e._v("#"+e._s(e.modelPr.number))])]),i("div",{staticClass:"title"},[i("el-row",{staticClass:"desc"},[e._v(" "+e._s(e.modelPr.department_name+"在"+e.parseTime(e.modelPr.create_datetime,"{y}年{m}月{d}日")+'发生了"'+e.modelPr.problem_department_type_name+'"的问题。')+" ")]),i("el-row",{staticStyle:{"margin-bottom":"10px"}},[e._v(" 来源： "),i("el-tag",{attrs:{type:"info",effect:"dark",size:"small"}},[e._v("人工录入")])],1),i("el-row",[e._v(" 状态： "),"UN_FEEDBACK"==e.modelPr.status?i("el-tag",{attrs:{type:"warning",effect:"dark",size:"small"}},[e._v("未反馈")]):e._e(),"FEEDBACK"==e.modelPr.status?i("el-tag",{attrs:{type:"success",effect:"dark",size:"small"}},[e._v("已反馈")]):e._e(),"FILED"==e.modelPr.status?i("el-tag",{attrs:{type:"info",effect:"dark",size:"small"}},[e._v("已归档")]):e._e()],1)],1)]),i("el-row",{staticClass:"prInfo",attrs:{type:"flex"}},[i("span",{staticClass:"title"},[e._v("问题详情")])]),i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("问题类别:")]),e._v(e._s(e.modelPr.problem_department_type_name)+" ")]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("问题类型:")]),e._v(e._s(e.modelPr.problem_department_type_parent_name)+" ")])]),i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("被检查单位:")]),e._v(e._s(e.modelPr.department_name)+" ")]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("问题责任人:")]),e._v(e._s(e.modelPr.resArry?e.modelPr.resArry.join(","):"")+" ")])]),i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("创建单位:")]),e._v(e._s(e.modelPr.from_department_name)+" ")]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("创建人:")]),e._v(e._s(e.modelPr.from_real_name+"("+e.modelPr.from_account_name+")")+" ")])]),i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("问题描述:")])]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("检查时间:")]),e._v(e._s(e.modelPr.create_datetime)+" ")])]),i("div",{staticClass:"content-desc"},[e._v(" "+e._s(e.htmlDecode(e.modelPr.content))+" ")]),i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[e._v("问题附件:")])])]),e._l(e.modelPr.storage_file,(function(t,s){return i("div",{key:s,staticClass:"content-row hand"},[i("div",{staticClass:"content-col"},[t.isImg?i("img",{staticClass:"img",attrs:{src:t.url2},on:{click:function(i){return e.viewImg(t.url2)}}}):e._e(),t.isImg?e._e():i("div",{staticClass:"file",on:{click:function(i){return e.downLoad(t.url2)}}},[i("img",{staticClass:"img",attrs:{src:e.fileImg}}),i("span",[e._v(e._s(t.url))]),i("div",{staticClass:"download"},[i("i",{staticClass:"el-icon-download"})])])])])}))],2),i("el-row",{staticClass:"prInfo",attrs:{type:"flex"}},[i("span",{staticClass:"title"},[e._v("问题反馈")])]),e.isFeedBack?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[e._v("该问题于【")]),e._v(e._s(e.modelFb.last_update_datetime)+" "),i("div",{staticClass:"content-title1"},[e._v("】被【")]),e._v(e._s(e.modelFb.from_admin_array[0].real_name)+"（"+e._s(e.modelFb.from_admin_array[0].name)+"）"),i("div",{staticClass:"content-title1"},[e._v("】反馈为")]),"UN_CONFIR"==e.modelPr.is_fact?i("el-tag",{attrs:{type:"info",effect:"dark"}},[e._v("未确认")]):e._e(),"NOT_FACT"==e.modelPr.is_fact?i("el-tag",{attrs:{type:"warning",effect:"dark"}},[e._v("失实")]):e._e(),"FACT"==e.modelPr.is_fact?i("el-tag",{attrs:{type:"success",effect:"dark"}},[e._v("属实")]):e._e()],1)]),i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[e._v("反馈情况如下:")])])]),i("div",{staticClass:"content-desc1"},[e._v(" "+e._s(e.htmlDecode(e.modelFb.content))+" ")]),i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[e._v("问题附件:")])])]),e._l(e.modelFb.storage_file,(function(t,s){return i("div",{key:s,staticClass:"content-row hand"},[i("div",{staticClass:"content-col"},[t.isImg?i("img",{staticClass:"img",attrs:{src:t.url2},on:{click:function(i){return e.viewImg(t.url2)}}}):e._e(),t.isImg?e._e():i("div",{staticClass:"file",on:{click:function(i){return e.downLoad(t.url2)}}},[i("img",{staticClass:"img",attrs:{src:e.fileImg}}),i("span",[e._v(e._s(t.url))]),i("div",{staticClass:"download"},[i("i",{staticClass:"el-icon-download"})])])])])}))],2):e._e(),e.isFeedBack||e.fbDisabled?e._e():i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[e._v("问题暂无反馈信息，点击”")]),i("el-link",{attrs:{type:"primary"},on:{click:e.openFbEidt}},[e._v("反馈问题")]),i("div",{staticClass:"content-title1"},[e._v("”开始编辑反馈信息!")])],1)])]),e.isFeedBack&&!e.fbDisabled?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[e._v("问题已存在反馈信息，点击”")]),i("el-link",{attrs:{type:"primary"},on:{click:e.openFbEidt}},[e._v("编辑问题")]),i("div",{staticClass:"content-title1"},[e._v("”开始编辑反馈信息!")])],1)])]):e._e(),!e.isFeedBack&&e.fbDisabled?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[e._v("问题暂无反馈信息。")])])])]):e._e()],1),i("div",{staticClass:"prOper"},[e.prDisabled?e._e():i("i",{staticClass:"el-icon-edit-outline iconInfo",staticStyle:{"font-size":"40px"},on:{click:e.openPrEdit}})])]),i("el-dialog",{attrs:{title:"问题修改",visible:e.openPr,width:"800px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.openPr=t}}},[i("el-form",{ref:"formPr",attrs:{"label-position":"top",model:e.formPr,rules:e.rulesPr}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"被检查问题单位",prop:"to_uuid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"被选择检查问题单位",clearable:"",filterable:""},on:{change:e.deptSelChange},model:{value:e.formPr.to_uuid,callback:function(t){e.$set(e.formPr,"to_uuid",t)},expression:"formPr.to_uuid"}},e._l(e.deptList,(function(e){return i("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"问题类型",prop:"problem_type"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择问题类型",disabled:"",clearable:"",filterable:""},on:{change:e.typeSelChange},model:{value:e.formPr.problem_type,callback:function(t){e.$set(e.formPr,"problem_type",t)},expression:"formPr.problem_type"}},e._l(e.problemType1,(function(e){return i("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"问题子类",prop:"type_uuid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择问题分类",clearable:"",filterable:""},model:{value:e.formPr.type_uuid,callback:function(t){e.$set(e.formPr,"type_uuid",t)},expression:"formPr.type_uuid"}},e._l(e.problemList,(function(e){return i("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1)],1)],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"问题描述",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入内容",maxlength:"5000","show-word-limit":""},model:{value:e.formPr.content,callback:function(t){e.$set(e.formPr,"content",t)},expression:"formPr.content"}})],1)],1)],1),0!=e.formPr.storage_file.length?i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"问题原附件"}},[i("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},e._l(e.formPr.storage_file,(function(t,s){return i("li",{key:s,staticClass:"el-upload-list__item is-success",staticStyle:{width:"100px",height:"100px"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:"jpeg"==t.suffix||"png"==t.suffix||"jpg"==t.suffix?t.url2:e.fileImg}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview"},[i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.delFile(t,"pr")}}})])])])})),0)])],1)],1):e._e(),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"问题新附件"}},[i("ZMUpload",{attrs:{uploadList:e.beforeUpdateImg2},on:{"update:uploadList":function(t){e.beforeUpdateImg2=t},"update:upload-list":function(t){e.beforeUpdateImg2=t}}})],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitPr}},[e._v("确 定")]),i("el-button",{on:{click:e.colsePr}},[e._v("取 消")])],1)],1),i("el-dialog",{attrs:{title:e.title,visible:e.openFb,width:"800px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.openFb=t}}},[i("el-form",{ref:"formFb",attrs:{model:e.formFb,rules:e.rulesFb,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"问题负责人"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"请输入姓名或警号","remote-method":e.remotePerson1,clearable:""},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.to_uuid_person,callback:function(t){e.to_uuid_person=t},expression:"to_uuid_person"}},e._l(e.personList1,(function(e){return i("el-option",{key:e.uuid,attrs:{label:e.name+"-"+e.real_name,value:e.uuid}})})),1)],1),i("el-form-item",{attrs:{label:"属实情况"}},[i("el-radio",{attrs:{label:"NOT_FACT"},model:{value:e.formFb.is_fact,callback:function(t){e.$set(e.formFb,"is_fact",t)},expression:"formFb.is_fact"}},[i("el-tag",{attrs:{type:"warning",effect:"dark"}},[e._v("失实")])],1),i("el-radio",{attrs:{label:"FACT"},model:{value:e.formFb.is_fact,callback:function(t){e.$set(e.formFb,"is_fact",t)},expression:"formFb.is_fact"}},[i("el-tag",{attrs:{type:"success",effect:"dark"}},[e._v("属实")])],1)],1),i("el-form-item",{attrs:{label:"反馈描述",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入内容",maxlength:"5000","show-word-limit":""},model:{value:e.formFb.content,callback:function(t){e.$set(e.formFb,"content",t)},expression:"formFb.content"}})],1),e.isFeedBack?i("el-form-item",{attrs:{label:"反馈原附件"}},[i("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},e._l(e.formFb.storage_file,(function(t,s){return i("li",{key:s,staticClass:"el-upload-list__item is-success",staticStyle:{width:"100px",height:"100px"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:"jpeg"==t.suffix||"png"==t.suffix||"jpg"==t.suffix?t.url2:e.fileImg}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview"},[i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.delFile(t,"fb")}}})])])])})),0)]):e._e(),i("el-form-item",{attrs:{label:e.isFeedBack?"反馈新附件":"反馈附件"}},[i("ZMUpload",{attrs:{uploadList:e.beforeUpdateImg},on:{"update:uploadList":function(t){e.beforeUpdateImg=t},"update:upload-list":function(t){e.beforeUpdateImg=t}}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitFb}},[e._v("确 定")]),i("el-button",{on:{click:e.colsePr}},[e._v("取 消")])],1)],1),e.imgViewerVisible?i("el-image-viewer",{attrs:{"on-close":e.closeImgViewer,"url-list":e.imgList}}):e._e()],1)},o=[],r=i("c7eb"),a=i("1da1"),l=i("2909"),n=i("5530"),c=(i("d3b7"),i("3ca3"),i("ddb0"),i("4de4"),i("14d9"),i("159b"),i("caad"),i("2532"),i("b0c0"),i("a15b"),i("d81d"),i("99af"),i("2f62")),d=i("25aa"),u=i("9d9a"),m=(i("df7c"),{computed:Object(n["a"])({},Object(c["b"])(["admin"])),components:{"el-image-viewer":function(){return Promise.all([i.e("chunk-elementUI"),i.e("chunk-cf7ab578")]).then(i.bind(null,"08a9"))},ZMUpload:d["a"]},data:function(){return{fileImg:i("87d4"),deptList:[],problemType1:[],problemType2:[],problemList:[],openPr:!1,openFb:!1,title:"",rulesPr:{to_uuid:[{required:!0,message:"被检查问题单位不能为空",trigger:"change"}],problem_type:[{required:!0,message:"问题类型不能为空",trigger:"change"}],type_uuid:[{required:!0,message:"问题子类不能为空",trigger:"change"}],content:[{required:!0,message:"问题描述不能为空",trigger:"change"}]},rulesFb:{content:[{required:!0,message:"问题描述不能为空",trigger:"change"}],is_fact:[{required:!0,message:"属实情况不能为空",trigger:"change"}]},beforeUpdateImg:[],beforeUpdateImg2:[],modelPr:{},modelFb:{},formPr:{to_uuid:"",type_uuid:"",content:"",problem_type:"",storage_file:[]},formFb:{is_fact:"",storage_file:[],content:""},problemNumber:"",operate:"",isFeedBack:!1,prDisabled:!1,fbDisabled:!1,imgViewerVisible:!1,imgList:[],uuid:"",to_uuid_person:[],userList1:[],personList1:[],manageUser:[]}},watch:{$route:{immediate:!0,handler:function(){this.$route.query.number&&(this.problemNumber=this.$route.query.number),this.$route.query.id&&(this.uuid=this.$route.query.id),this.$route.query.operate,this.getData()}}},created:function(){},methods:{quickTo:function(e){this.$el.querySelector("#div"+e).scrollIntoView({block:"start",behavior:"smooth"})},getData:function(){this.isFeedBack=!1,this.prDisabled=!1,this.fbDisabled=!1,this.beforeUpdateImg=[],this.beforeUpdateImg2=[],this.modelPr={},this.modelFb={},this.formPr={to_uuid:"",type_uuid:"",content:"",problem_type:"",storage_file:[]},this.formFb={is_fact:"",storage_file:[],content:""},this.getProblemInfo(),this.getDepartmentList(),this.checkRole()},getDepartmentList:function(){var e=this;Object(u["j"])({level:2}).then((function(t){e.deptList=t.array}))},getDeptProblemTypeList:function(){var e=this;Object(u["t"])().then((function(t){t.array.length>0&&(e.problemType1=t.array.filter((function(e){return 1==e.level})),e.problemType2=t.array.filter((function(e){return 2==e.level})))}))},getProblemInfo:function(){var e=this,t={offset:0,rows:1};this.problemNumber&&(t.number=this.problemNumber),this.uuid&&(t.uuid=this.uuid),Object(u["v"])(t).then((function(t){if(t.array.length>0){if(e.modelPr=t.array[0],"FILED"==e.modelPr.status&&(e.fbDisabled=!0,e.prDisabled=!0),"zd_admin"==e.admin.role_name&&(e.fbDisabled=!0,e.admin.uuid!=e.modelPr.from_uuid&&(e.prDisabled=!0)),"zd_leader"==e.admin.role_name&&e.admin.department_uuid2!=e.modelPr.to_department_uuid&&(e.fbDisabled=!0),e.modelPr.responsible_uuid&&e.modelPr.responsible_uuid.length>0){for(var i=[],s=0;s<e.modelPr.responsible_real_name.length;s++)i.push(e.modelPr.responsible_real_name[s]+"("+e.modelPr.responsible_account_name[s]+")");e.modelPr.resArry=i}else e.modelPr.resArry=[];e.modelPr.storage_file&&e.modelPr.storage_file.length>0?e.modelPr.storage_file.forEach((function(e){e.url2="http://192.168.10.150:9010/webapp/problem_file/"+e.url,e.suffix.includes("jpeg")||e.suffix.includes("png")||e.suffix.includes("jpg")||e.suffix.includes("gif")?e.isImg=!0:e.isImg=!1})):e.modelPr.storage_file=[],console.log(e.modelPr.storage_file),e.getDeptProblemTypeList(),e.getProblemFeedBack(),e.getManager()}}))},getProblemFeedBack:function(){var e=this,t={problem_uuid:this.modelPr.uuid,offset:0,rows:1};Object(u["m"])(t).then((function(t){t.array.length>0&&(e.prDisabled=!0,e.modelFb=t.array[0],e.modelFb.storage_file&&e.modelFb.storage_file.length>0?e.modelFb.storage_file.forEach((function(e){e.url2="http://192.168.10.150:9010/webapp/problem_file/"+e.url,e.suffix.includes("jpeg")||e.suffix.includes("png")||e.suffix.includes("jpg")||e.suffix.includes("gif")?e.isImg=!0:e.isImg=!1})):e.modelFb.storage_file=[],e.isFeedBack=!0)}))},getManager:function(){var e=this,t={offset:0,rows:1e3,manage_department_uuid_like:this.modelPr.to_department_uuid};Object(u["i"])(t).then((function(t){e.manageUser=t.array}))},checkRole:function(){"fu_jing"!=this.admin.role_name&&"min_jing"!=this.admin.role_name||(this.prDisabled=!0,this.fbDisabled=!0)},deptSelChange:function(e){this.formPr.type_uuid="",this.formPr.problem_type="",this.problemList=[]},typeSelChange:function(e){this.formPr.type_uuid="",this.problemList=[],this.problemList=this.problemType2.filter((function(t){return t.parent_uuid==e}))},openPrEdit:function(){var e=this;this.beforeUpdateImg2=[],this.formPr.photos=[],Object.assign(this.formPr,this.modelPr),this.formPr.content=this.htmlDecode(this.formPr.content),this.problemType1.forEach((function(t){t.name==e.modelPr.problem_department_type_parent_name&&(e.formPr.problem_type=t.uuid)})),this.problemList=this.problemType2.filter((function(t){return t.parent_uuid==e.formPr.problem_type})),this.openPr=!0},submitPr:function(){var e=this,t=this;this.$refs["formPr"].validate((function(i){if(i)if(e.formPr.content=e.htmlEncode(e.formPr.content),t.beforeUpdateImg2.length>0){var s={file_content:t.beforeUpdateImg2.map((function(e){return e.content})).join("|"),file_suffix:t.beforeUpdateImg2.map((function(e){return e.suffix})).join("|"),associate_type:"PROBLEM",associate_uuid:t.formPr.uuid};Object(u["e"])(s).then((function(e){var i={uuid:t.formPr.uuid,to_uuid:t.formPr.to_uuid,type_uuid:t.formPr.type_uuid,content:t.formPr.content};Object(u["g"])(i).then((function(e){t.$modal.msgSuccess("处理成功"),t.getProblemInfo(),t.openPr=!1}))}))}else{var o={uuid:t.formPr.uuid,to_uuid:t.formPr.to_uuid,type_uuid:t.formPr.type_uuid,content:t.formPr.content};Object(u["g"])(o).then((function(e){t.$modal.msgSuccess("处理成功"),t.getProblemInfo(),t.openPr=!1}))}}))},colsePr:function(){this.getProblemInfo(),this.openPr=!1,this.openFb=!1},remotePerson1:function(e){var t=this,i=0;this.personList1=[],this.userList1.forEach((function(s){(-1!=s.real_name.indexOf(e)&&i<=20||-1!=s.name.indexOf(e)&&i<=20)&&(t.personList1.push(s),i++)}))},openFbEidt:function(){var e=this;this.to_uuid_person=[],this.beforeUpdateImg=[],this.formFb.photos=[],this.isFeedBack?(this.formFb.content=this.modelFb.content,this.formFb.content=this.htmlDecode(this.modelFb.content),this.formFb.storage_file=this.modelFb.storage_file,this.formFb.is_fact=this.modelPr.is_fact,this.title="修改反馈"):(this.title="问题反馈",this.formFb.is_fact="FACT"),this.modelPr.responsible_uuid&&this.modelPr.responsible_uuid.length>0?this.to_uuid_person=Object(l["a"])(this.modelPr.responsible_uuid):this.to_uuid_person=[],this.formFb.problem_uuid=this.modelPr.uuid,this.formFb.from_uuid=this.admin.uuid;var t={rows:1e3,offset:0,all_from_department_uuid:this.modelPr.to_department_uuid};Object(u["i"])(t).then((function(t){e.userList1=t.array,e.personList1=Object(l["a"])(e.userList1),e.openFb=!0,console.log(e.formFb)}))},submitFb:function(){var e=this;this.beforeUpdateImg.length>0&&(this.formFb.file_content=this.beforeUpdateImg.map((function(e){return e.content})).join("|"),this.formFb.file_suffix=this.beforeUpdateImg.map((function(e){return e.suffix})).join("|")),this.$refs["formFb"].validate((function(t){if(t)if(e.formFb.content=e.htmlEncode(e.formFb.content),e.isFeedBack){var i=e;if(i.beforeUpdateImg.length>0){var s={file_content:i.beforeUpdateImg.map((function(e){return e.content})).join("|"),file_suffix:i.beforeUpdateImg.map((function(e){return e.suffix})).join("|"),associate_type:"FEEDBACK",associate_uuid:i.modelFb.uuid};Object(u["e"])(s).then((function(e){var t={uuid:i.modelFb.uuid,content:i.formFb.content};Object(u["z"])(t).then((function(e){i.sendMsg(),i.updatePr()}))}))}else{var o={uuid:i.modelFb.uuid,content:i.formFb.content};Object(u["z"])(o).then((function(e){i.sendMsg(),i.updatePr()}))}}else Object(u["a"])(e.formFb).then((function(t){e.sendMsg(),e.updatePr()}))}))},updatePr:function(){var e=this,t={uuid:this.formFb.problem_uuid,fact:this.formFb.is_fact,read:"READ",status:"FEEDBACK",responsible_uuids:0==this.to_uuid_person.length?"clear":this.to_uuid_person.join(";")};Object(u["g"])(t).then((function(t){e.$modal.msgSuccess("处理成功"),e.getProblemInfo(),e.openFb=!1}))},downLoad:function(e){window.open(e)},delFile:function(e,t){var i=this,s=this;this.$modal.confirm("是否确认删除该附件").then((function(){Object(u["C"])({uuid:e.uuid}).then((function(i){"pr"==t?s.formPr.storage_file=s.formPr.storage_file.filter((function(t){return t!=e})):s.formFb.storage_file=s.formFb.storage_file.filter((function(t){return t!=e})),s.$forceUpdate()}))})).then((function(){i.handleQuery(),i.$modal.msgSuccess("删除成功")})).catch((function(){}))},viewImg:function(e){this.imgViewerVisible=!0,this.imgList=[e]},closeImgViewer:function(){this.imgViewerVisible=!1},sendMsg:function(){var e=this;return Object(a["a"])(Object(r["a"])().mark((function t(){var i,s,o,a,l,n;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=[],e.manageUser.length>0&&(i=i.concat(e.manageUser.map((function(e){return e.uuid})))),s=0;case 3:if(!(s<i.length)){t.next=11;break}return o=e.modelPr.department_name+"，在“"+e.modelPr.create_datetime+"”被发现“"+e.modelPr.problem_department_type_name+"”的问题已做反馈，请查看反馈详情。",a={from_uuid:e.admin.uuid,to_uuid:i[s],title:"反馈产生通知",content:o,remark:e.modelPr.uuid},t.next=8,e.addMsg(a);case 8:s++,t.next=3;break;case 11:if(!(e.modelPr.responsible_uuid&&e.modelPr.responsible_uuid.length>0)){t.next=21;break}l=0;case 13:if(!(l<e.modelPr.responsible_uuid.length)){t.next=21;break}return o=""+e.modelPr.department_name+e.modelPr.responsible_real_name[l]+"（"+e.modelPr.responsible_account_name[l]+"），在“"+e.modelPr.create_datetime+"”被发现“"+e.modelPr.problem_department_type_name+"”的问题已做反馈，请查看反馈详情。",n={from_uuid:e.admin.uuid,to_uuid:e.modelPr.responsible_uuid[l],title:"反馈产生通知",content:o,remark:e.modelPr.uuid},t.next=18,e.addMsg(n);case 18:l++,t.next=13;break;case 21:case"end":return t.stop()}}),t)})))()},addMsg:function(e){return new Promise((function(t){Object(u["b"])(e).then((function(e){return t("nextt")}))}))}}}),f=m,p=(i("9a5c"),i("2877")),_=Object(p["a"])(f,s,o,!1,null,null,null);t["default"]=_.exports},"87d4":function(e,t,i){e.exports=i.p+"static/img/file.78a29ab7.png"},"9a5c":function(e,t,i){"use strict";i("0987")}}]);